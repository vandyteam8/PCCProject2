---
#
# EECS 4287/5287: Principles of Cloud Computing
# Author: Aniruddha Gokhale
# Created: Fall 2016
# Modified: Fall 2020
#
# This playbook will install some packages on cloud VM
# Our cloud can be Horizon Cloud VM or Chameleon VMs or AWS VMs

  - name: download couchdb PPA repository
    become: yes
    apt_key: 
      url: https://couchdb.apache.org/rep/bintray-pubkey.asc
      state: present
      
  - name: Install couchdb
    become: yes
    apt:
      name: couchdb
    register: couchdb_install

  - name: stop couchdb
    become: yes
    service:
      name: couchdb
      state: stopped
    when: couchdb_install.changed

  - name: couchdb bind to 0.0.0.0
    lineinfile: 
      path: /etc/couchdb/local.ini
      regexp: ;bind_address = 127.0.0.1
      line: bind_address = 0.0.0.0


...

